% SIAM Article Template
\documentclass[review,hidelinks,onefignum,onetabnum]{siamart220329}

% Information that is shared between the article and the supplement
% (title and author information, macros, packages, etc.) goes into
% ex_shared.tex. If there is no supplement, this file can be included
% directly.

% Packages and macros go here
\usepackage{lipsum}
\usepackage{amsfonts}
\usepackage{epstopdf}
\usepackage{url}
% \usepackage{algorithmic}
\ifpdf
  \DeclareGraphicsExtensions{.eps,.pdf,.png,.jpg}
\else
  \DeclareGraphicsExtensions{.eps}
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Paul's commands - note that some had to be commented out

\usepackage[normalem]{ulem}
\usepackage[labelfont=bf]{caption}
\usepackage[labelformat=empty]{subcaption}


\usepackage{microtype, fancyhdr,
  siunitx, graphicx, hyperref, epstopdf, tikz, adjustbox, mathtools, float,
  anyfontsize, relsize}
\usepackage{bm, amssymb, amsmath, mathrsfs}
\usepackage{etoolbox}
\usepackage[algo2e, ruled, linesnumbered, resetcount]{algorithm2e}
\SetFuncSty{textsc}
\SetKwProg{Function}{}{:}{}
\SetKwComment{Comment}{$\triangleright$\ }{}

\input{preamble.tex}

\def\spacingset#1{\renewcommand{\baselinestretch}%
{#1}\small\normalsize} \spacingset{1}

\sisetup{exponent-mode=input, retain-zero-exponent=true}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Add a serial/Oxford comma by default.
\newcommand{\creflastconjunction}{, and~}

% Used for creating new theorem and remark environments
\newsiamremark{remark}{Remark}
\newsiamremark{hypothesis}{Hypothesis}
\crefname{hypothesis}{Hypothesis}{Hypotheses}
\newsiamthm{claim}{Claim}

% Sets running headers as well as PDF title and authors
\headers{A Nonuniform Fast Hankel Transform}{Paul G. Beckman and Michael O'Neil}

% Title. If the supplement option is on, then "Supplementary Material"
% is automatically inserted before the title.
\title{A Nonuniform Fast Hankel Transform\thanks{Submitted to the editors DATE.
    \funding{P. G. Beckman was partially supported by the Office of Naval
    Research under award \#N00014-21-1-2383 and by the U.S.  Department of
    Energy, Office of Science, Office of Advanced Scientific Computing Research,
    Department of Energy Computational Science Graduate Fellowship under Award
    Number DE-SC0022158. M. O'Neil was partially supported by the Office of
    Naval Research under award \#N00014-21-1-2383.}  } }

% Authors: full names plus addresses.
\author{Paul G. Beckman\thanks{Courant Institute, New York University, New York, NY\\
  (\email{paul.beckman@cims.nyu.edu}, \url{https://cims.nyu.edu/\~pgb8409}).}
\and Michael O'Neil\thanks{Courant Institute, New York University, New York, NY\\
  (\email{oneil@cims.nyu.edu}, \url{https://cims.nyu.edu/\~oneil}).}
}

\usepackage{amsopn}
\DeclareMathOperator{\diag}{diag}

% Optional PDF information
\ifpdf
\hypersetup{
  pdftitle={A Nonuniform Fast  Hankel Transform}
  pdfauthor={P. G. Beckman and M. O'Neil}
}
\fi

% The next statement enables references to information in the
% supplement. See the xr-hyperref package for details.

%\externaldocument[][nocite]{ex_supplement}

% FundRef data to be entered by SIAM
%<funding-group specific-use="FundRef">
%<award-group>
%<funding-source>
%<named-content content-type="funder-name"> 
%</named-content> 
%<named-content content-type="funder-identifier"> 
%</named-content>
%</funding-source>
%<award-id> </award-id>
%</award-group>
%</funding-group>

\begin{document}

\maketitle

% REQUIRED
\begin{abstract}
  \input{./src/abstract.tex}
\end{abstract}

% REQUIRED
\begin{keywords}
Hankel transform, fast Fourier transform, asymptotic expansion, Bessel function
\end{keywords}

% REQUIRED
\begin{MSCcodes}
XXXX, XXXX, XXXX
\end{MSCcodes}







\section{Introduction} 
\input{./src/intro.tex}


\section{Overview of the algorithm}
\label{sec:overview}


{\color{red} Derive matrix form here, use $F = J f$ as notation?}
product with $\bm{A} \in \R^{m \times n}$
\begin{equation}
    \bm{g} = \bm{A}\bm{c}, \qquad \bm{A}_{jk} = J_\nu(\omega_j r_k).
\end{equation}


Show matrix arising from DHT, draw bands, say what happens in each region: local
expansion, direct, asymptotic, and why the local expansion can be accelerated

\begin{figure}
  \centering
  \begin{subfigure}[b]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figures/bessel_function.pdf}
  \end{subfigure}
  \begin{subfigure}[b]{0.45\textwidth}
    \includegraphics[width=\textwidth]{./figures/pointwise_errors.pdf}
  \end{subfigure}
  \caption{Bessel function $J_0(z)$ and pointwise relative error in approximating $J_0(z)$ using local and asymptotic expansions. Dotted vertical line shows crossover point where both expansions are accurate to $\epsilon = 10^{-12}$.}
\end{figure}

\begin{figure}
  \centering
  \newcommand\twa{0.29cm}
  \newcommand\tw{0.43cm}
  \begin{subfigure}[b]{0.23\textwidth}
    \includegraphics[width=\textwidth, trim={\twa, \twa, \twa, \twa}, clip]{./figures/splitting.pdf}
    \caption{}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.23\textwidth}
    \includegraphics[width=\textwidth, trim={\tw, \tw, \tw, \tw}, clip]{./figures/splitting_lvl1.pdf}
    \caption{Level 1}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.23\textwidth}
    \includegraphics[width=\textwidth, trim={\tw, \tw, \tw, \tw}, clip]{./figures/splitting_lvl2.pdf}
    \caption{Level 2}
  \end{subfigure}
  \hfill
  \begin{subfigure}[b]{0.23\textwidth}
    \includegraphics[width=\textwidth, trim={\tw, \tw, \tw, \tw}, clip]{./figures/splitting_lvl3.pdf}
    \caption{Level 3}
  \end{subfigure}
  \caption{Splitting of Hankel transform matrix $\bm{A}$ into local and asymptotic entries, and adaptive subdivision of $\bm{A}$ into corresponding sub-blocks by expansion.}
\end{figure}

\section{Bessel function approximations}
\label{sec:approx}
\input{./src/approx.tex}


\section{Methods} \label{sec:methods}
\input{./src/methods.tex}


{\color{red}

  \section{The Nonuniform Fast Hankel Transform}
\label{sec:nufht}

asdf

\subsection{The algorithm}
\label{sec:algorithm}

asdf


\subsection{Complexity analysis}
\label{sec:complexity}

asdf
}

\section{Numerical examples}
\label{sec:results}
\input{./src/results.tex}

\section{Discussion} \label{sec:discussion}
\input{./src/discussion.tex}

\section*{Acknowledgments}
The authors would like to thank Alex Barnett for suggesting the use of the Wimp
expansion.

\section*{Competing interests}
The authors report no competing interests.

\bibliographystyle{siamplain}
\bibliography{refs}

\end{document}

%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: t
%%% End:
