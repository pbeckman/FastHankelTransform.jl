\SetKwFunction{NUFHT}{NUFHT}
\Function{\NUFHT{$\nu, \epsilon, \bm{r}, \bm{c}, \bm{\omega}$}}{
    $\bm{g} = \bm{0}$ \\
    Choose $M$ using (\ref{eq:num-asy-terms}) \\
    Look up $L = L_{\nu,\epsilon}^{M}$ and $z = z_{\nu,\epsilon}^{M}$ from pre-computed tables \\
    Choose \texttt{\upshape min\_size} from numerical experiments (e.g. default 1024)
    $(\mathscr{L}, \mathscr{A}, \mathscr{D}) = \textsc{Subdivide}(r_1,\dots,r_n, \omega_1,\dots,\omega_m, z, \texttt{\upshape min\_size})$ \\
    \For{$\mathscr{B} \in (\mathscr{L}, \mathscr{A}, \mathscr{D})$}{
        \For{$(j_0:j_1, k_0:k_1) \in \mathscr{B}$}{
            $\bm{g}(j_0:j_1) \pluseq \bm{A}(j_0:j_1, k_0:k_1) \bm{c}(k_0:k_1)$ using corresponding expansion \\
        }
    }
    \Return{$\bm{g}$}
}