\subsection{The Wimp expansion}
\label{sec:local}


If one looks at a rectangle $[0, \Omega] \times [0, R]$ where $\Omega R$ is
sufficiently small, $J_\nu(\omega r)$ is approximately low-rank for all $\omega
\in [0, \Omega], r \in [0, R]$. Fortuitously, one such low-rank approximation is
available in closed form \cite{wimp1962polynomial}. In the case that $\nu$ is
even, we have
\begin{align}
    J_\nu(xy) 
    &= \sum_{\ell=0}^\infty C_\ell(x) T_{2\ell}(y) \\
    C_\ell(x) 
    &= \delta_\ell J_{\frac{\nu}{2} + \ell}(x) \, J_{\frac{\nu}{2} - \ell}(x) \\
    \delta_\ell 
    &= \begin{cases}
        1 & \ell=0 \\
        2 & \text{otherwise}
    \end{cases}
    % J_{2\eta + 1}(\omega r) 
    % &= \sum_{\ell=0}^\infty 2J_{\eta + \ell + 1}(\omega R) \, J_{\eta - \ell}(\omega R) \, T_{2\ell+1}\left( \frac{r}{R} \right)
\end{align}
for $\abs{y} \leq 1$. An analogous expansion exists for $\nu$ odd.

\begin{lemma} \label{lem:wimp} Truncating the Wimp expansion after $L$ terms
    gives
    \begin{align}
        \abs{J_\nu(\omega r) - \sum_{\ell=0}^L C_\ell(\omega R) T_{2\ell}\left( \frac{r}{R} \right)} 
        \leq \frac{2\exp\left\{ \frac{\nu}{2}(\beta - \gamma) + (L+1)(\beta + \gamma) \right\}}{1 - e^{\beta + \gamma}}
    \end{align}
    for all $\omega \in [0, \Omega], r \in [0, R]$, where
    \begin{align}
        \psi(p) &:= \log p + \sqrt{1 - p^2} - \log\left( 1 + \sqrt{1 - p^2} \right) \\
        \beta &:= \psi\left( \frac{\Omega R}{\nu + 2L + 2} \right) \\
        \gamma &:= \begin{cases}
            \psi\left( \frac{\Omega R}{2L + 2 - \nu} \right) & L + 1 \geq \frac{\nu}{2} \\
            0 & \textnormal{otherwise}
        \end{cases}
    \end{align}
\end{lemma}
\begin{proof}
    For $\nu$ even, the truncation error after $L$ terms is bounded by
    \begin{align}
        \abs{\sum_{\ell=L+1}^\infty C_\ell(\omega R) T_{2\ell}\left( \frac{r}{R} \right)}
        &\leq 2\sum_{\ell=L+1}^\infty \abs{J_{\frac{\nu}{2} + \ell}\left(\frac{\omega R}{2}\right)} \abs{J_{\frac{\nu}{2} - \ell}\left(\frac{\omega R}{2}\right)}.
    \end{align}
    Define $p_\ell(\omega) := \omega R / (\nu + 2\ell)$. Then by Siegel's bound
    \cite[10.14.5]{olver2010nist} we have
    \begin{align}
        \abs{J_{\frac{\nu}{2} + \ell}\left(\frac{\omega R}{2}\right)}
        &= \abs{J_{\frac{\nu}{2} + \ell}\bigg(\Big(\frac{\nu}{2} + \ell\Big) p_\ell(\omega)\bigg)} \\
        &\leq \exp\left\{ \Big(\frac{\nu}{2} + \ell\Big) \psi\big(p_\ell(\omega)\big)\right\} \\
        &\leq \exp\left\{ \Big(\frac{\nu}{2} + \ell\Big) \beta \right\},
    \end{align}
    where the last inequality follows from the fact that $\psi$ is an increasing
    function on $(0,1)$, and thus $\psi\big(p_\ell(\omega)\big) \leq \beta < 0$
    for all $\ell \geq L+1$ and all $\omega \in [0, \Omega]$. 
    
    If $L+1 \geq \frac{\nu}{2}$, we define $q_\ell(\omega) := \omega R / (2\ell
    - \nu)$ and apply Siegel's bound again to obtain
    \begin{align}
        \abs{J_{\frac{\nu}{2} - \ell}\left(\frac{\omega R}{2}\right)}
        &= \abs{J_{\ell - \frac{\nu}{2}}\bigg(\Big(\ell - \frac{\nu}{2}\Big) q_\ell(\omega)\bigg)} 
        \leq \exp\left\{ \Big(\ell - \frac{\nu}{2}\Big) \gamma \right\}.
    \end{align}
    If $L+1 < \frac{\nu}{2}$, Siegel's bound does not apply and we use instead
    the simple bound $\abs{J_{\frac{\nu}{2} - \ell}\left(\frac{\omega
    R}{2}\right)} \leq 1$, which is equivalent to taking $\gamma = 0$. 

    All that remains is to apply a geometric series argument
    \begin{align}
        \abs{J_\nu(\omega r) - \sum_{\ell=0}^L C_\ell(\omega R) T_{2\ell}\left( \frac{r}{R} \right)}
        &\leq 2\sum_{\ell=L+1}^\infty \exp\left\{ \Big(\frac{\nu}{2} + \ell\Big) \beta + \Big(\ell - \frac{\nu}{2}\Big) \gamma \right\} \\
        &= 2\exp\left\{\frac{\nu}{2}(\beta - \gamma)\right\} \sum_{\ell=L+1}^\infty \left( e^{\beta + \gamma} \right)^\ell \\
        &= \frac{2\exp\left\{ \frac{\nu}{2}(\beta - \gamma) + (L+1)(\beta + \gamma) \right\}}{1 - e^{\beta + \gamma}}
    \end{align}
    A similar calculation can be carried out for $\nu$ odd.
\end{proof}

Lemma \ref{lem:wimp} is rather opaque regarding the impact of the various
parameters because we have not utilized any simplifying bounds on the function
$\psi$. However, it remains relatively tight for $\nu = 0$ and is sufficient for
our purposes, because given $z, L > 0$, it gives a bound on the pointwise error
in approximating any block of the matrix $J_\nu(\omega_j r_k)$ for which $\omega
r \leq z$ using the $L$-term Wimp expansion. For a block of $\bm{A}$ of size
$m_b \times n_b$, the low-rank approximation given by the Wimp expansion can be
applied to a vector in $\bO\big(L(m_b + n_b)\big)$ time.




\subsection{Hankel's expansion}
\label{sec:asymptotic}
asdf

The first $2M$ terms of Hankel's expansion for $z \to \infty$ are given by
\begin{align} \label{eq:asymptotic-expansion}
    J_\nu(z)
    \sim \sqrt{\frac{2}{\pi z}} \left( 
        \cos\left(\mu\right) \sum_{\ell=0}^{M-1} (-1)^\ell \frac{a_{2\ell}(\nu)}{z^{2\ell}}
        - \sin\left(\mu\right) \sum_{\ell=0}^{M-1} (-1)^\ell \frac{a_{2\ell+1}(\nu)}{z^{2\ell+1}}
        \right)
\end{align}
where $\mu := z - \frac{(2\nu+1)\pi}{4}$ and 
\begin{align}
    a_\ell(\nu) := \frac{(4\nu^2 - 1)(4\nu^2 - 3)\dots(4\nu^2 - (2\ell-1)^2)}{\ell! 8^\ell}.
\end{align}

\red{Matvec evaluation with the NUFFT in $\bO\big(M(n + m\log m)\big)$ time}

\red{Error bound}





\subsection{Expansion orders}
\label{sec:cutoff}

Explain how to compute cutoff tolerances, and in what error norm



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
